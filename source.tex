%%AMC:preprocess_command=prePythonTex4AMC
%%AMC:jobspecific=1
%%AMC:latex_engine=pdflatex --shell-escape

% Compilation Texmaker : Utilisateur/Commandes utilisateur
%--------------------------
% Shell Python :
% pdflatex --shell-escape -synctex=1 -interaction=nonstopmode %.tex|
% python /usr/share/texlive/texmf-dist/scripts/pythontex/pythontex.py %.tex|
% pdflatex --shell-escape -synctex=1 -interaction=nonstopmode %.tex|
%------------------------
% Copier-coller la ligne ci-dessous dans Utilisateur/Commandes Utilisateur/Editer Commandes Utilisateur
%------------------------
% pdflatex --shell-escape -synctex=1 -interaction=nonstopmode %.tex | python /usr/share/texlive/texmf-dist/scripts/pythontex/pythontex.py %.tex | pdflatex --shell-escape -synctex=1 -interaction=nonstopmode %.tex
%--------------------------

\documentclass[a5paper]{article}
\RequirePackage{etex}
\usepackage[utf8]{inputenc}    
\usepackage[T1]{fontenc}

\usepackage[francais,bloc,completemulti]{automultiplechoice}    
\usepackage{fancyhdr,amssymb,amsmath}

% ---------- Utilisation de codes Python -----
\usepackage{pythontex}
\usepackage{csvsimple}
%----------------------------------------------
\def\barQ{b=1,m=-0.25}
\def\barP{b=1,m=0}

\begin{pycode}
import numpy as np
import math
from fractions import Fraction as F
from sympy import *


np.random.seed(12345)
# IMPORTANT : Graine pour la fonction random


def polyv2(b,p,d,q) :
	x=Symbol('x')
	myp = expand((x-b)**p*(x-d)**q)
	return latex(myp)
	
def dp1x(a,b,c) :
    x=Symbol('x')
    y=Symbol('y')
    f=(a*y-1)/(b*x-1)**c

    g=diff(f,x,1)
    g2=g/b
    g3=g*(-1)
    g4=g2*(-1)

	 
    gl = latex(g)
    g2l = latex(g2)
    g3l = latex(g3)
    g4l = latex(g4)

    return np.array([gl,g2l,g3l,g4l])

def fonction(a,x1,x2) :
    x=Symbol('x')
    f=a*x*x-a*(x1+x2)*x+a*x1*x2
    fl=latex(f)
    d=np.random.randint(2,5)
    y=-a*(x1+x2)*x+a*(x1*x2+d**2)
    yl=latex(y)
    yi=a*(d**2+x1*x2-(x1+x2)*d)
    yib=a*(d**2+x1*x2+(x1+x2)*d)
    return np.array([fl,yl,d,yi,yib])

def fonctionAff(a,b) :
    f=lambda x:a*x+b
    return f

def canonique(a,b,c) :
    x=Symbol('x')
    delta=b*b-4*a*c
    xs=F(-b,2*a)
    ys=F(-delta,4*a)
    f=a*(x-xs)**2+ys
    fl = latex(f)
    f2=a*(x+xs)**2+ys
    f2l = latex(f2)
    f3=a*(x-xs)**2-ys
    f3l = latex(f3)
    f4=a*(x+xs)**2-ys
    f4l = latex(f4)
    return np.array([fl,f2l,f3l,f4l])

def sommet(a,b,c) :
    delta=b*b-4*a*c
    xs=F(b+c,2)
    ys=F(a*(xs-b)*(xs-c),1)
    return np.array([xs,ys])

def factor(b,c) :
    x=Symbol('x')
    ff=(x-b)*(x-c)
    ffl = latex(ff)
    ff2=(x-b)*(x+c)
    ff2l=latex(ff2)
    ff3=(x+b)*(x-c)
    ff3l=latex(ff3)
    ff4=(x+b)*(x+c)
    ff4l=latex(ff4)
    return np.array([ffl,ff2l,ff3l,ff4l])

def coeff() :
    pair=[2,4,6,8,10]
    impair=[1,3,5,7,9]
    a=np.random.randint(-7,7)
    while a == 0:
	a=np.random.randint(-7,7)
    x1=np.random.randint(-10,-2)
    if (x1&1) :
    	x2=np.random.choice(impair) 
    else :
	x2=np.random.choice(pair)
    if x2==-x1:
        x2=x2+2
    if -x1 > x2:
	x3=x2
	x4=-x1
    else:
	x3=-x1
	x4=x2
    return np.array([a,x1,x2,x3,x4])

def image(a,b,c,x) :
    return a*x*x+b*x+c

def imageF(f,*args) :
    return f(*args)


def signe(a):
    if a > 0:
        return ("positif","negatif")
    return ("negatif","positif")

def position(a):
    if a > 0:
        return ("au-dessous","au-dessus")
    return ("au-dessus","au-dessous")

def antecedentAff(a,b,c):
	return (c-b)/a

def antecedentAffEnt(a,b):
    c=np.random.randint(-9,9)
    c=c*a-b
    return c

\end{pycode}



\element{qqs}{



\begin{question}{graphique}\bareme{\barQ}
Quelle est l'antécédent de $\py{e}$ par f ?
			\begin{reponseshoriz}
				\bonne   {$\py{antecedentAff(a,b,e)}$}
				\mauvaise{$\py{antecedentAff(c,d,e)}$} 				
 				\mauvaise{$\py{imageF(foncf,e)}$}
 				\mauvaise{$\py{imageF(foncg,e)}$}
			\end{reponseshoriz}
\end{question}
}

\element{qqs}{
\begin{question}{imagef}\bareme{\barQ}
Quelle est l'image de $\py{f}$ par f ?
			\begin{reponseshoriz}
				\bonne   {$\py{imageF(foncf,f)}$}
				\mauvaise{$\py{imageF(foncg,f)}$} 				
 				\mauvaise{$\py{antecedentAff(a,b,f)}$}
 				\mauvaise{$\py{antecedentAff(c,d,f)}$}
			\end{reponseshoriz}
\end{question}
}


\element{qqs}{
\begin{question}{imageg}\bareme{\barQ}
Quelle est l'image de $\py{e}$ par g ?
			\begin{reponseshoriz}
				\bonne   {$\py{imageF(foncg,e)}$}
				\mauvaise{$\py{imageF(foncf,e)}$} 				
 				\mauvaise{$\py{antecedentAff(a,b,e)}$}
 				\mauvaise{$\py{antecedentAff(c,d,e)}$}
			\end{reponseshoriz}
\end{question}
}

\element{qqs}{
\begin{question}{antecedentg}\bareme{\barQ}
Quel est l'antécédent de $\py{f}$ par g ?
			\begin{reponseshoriz}
				\bonne   {$\py{antecedentAff(c,d,f)}$}
				\mauvaise{$\py{antecedentAff(a,b,f)}$} 				
 				\mauvaise{$\py{imageF(foncf,f)}$}
 				\mauvaise{$\py{imageF(foncg,f)}$}
			\end{reponseshoriz}
\end{question}
}

%--------
% DOCUMENT
%--------
\begin{document}

\newcommand{\sujet}{
\exemplaire{0}{
%\pyc{a=np.random.randint(2,7)} %

%\pyc{x1=np.random.randint(-6,-1)} %
 
%\pyc{x2=np.random.randint(2,8)} % 
\pyc{coefs=coeff()}
\pyc{a=coefs[0]}
\pyc{x1=coefs[1]}
\pyc{x2=coefs[2]}
\pyc{x3=coefs[3]}
\pyc{x4=coefs[4]}

\AMCassociation{\id}
%%% debut de l'en-tête des copies :   


\begin{minipage}{.4\linewidth}
\centering\large\bf Interro Mathématiques\\Mardi 08.10.2019 \end{minipage}
\champnom{\fbox{    
                \begin{minipage}{.5\linewidth}
                  \begin{center} \nom{} \prenom{} \end{center}
		
                \end{minipage}
         }}
Calculatrice autorisée.


\begin{minipage}{0.96\linewidth}
\vspace*{3mm} %3mm
% texte de presentation 

	\end{minipage}\hspace*{\fill}
	
	
\vspace{5ex}

%%% fin de l'en-tête


\pyc{a=np.random.randint(1,9)}
\pyc{b=np.random.randint(-9,-1)}
\pyc{c=np.random.randint(-9,-1)}
\pyc{d=np.random.randint(1,9)}
\pyc{e=np.random.randint(-9,9)*a+b}
\pyc{f=np.random.randint(-9,9)*c+d} 
\pyc{foncf=fonctionAff(a,b)}
\pyc{foncg=fonctionAff(c,d)}

Soit f et g les fonctions qui ont pour expression algébrique : $f(x)= \pyc{x=Symbol('x');latex(print(foncf(x)))}$ et $g(x)= \pyc{x=Symbol('x');print(foncg(x))}$\\

\melangegroupe{qqs}

\restituegroupe{qqs}

}
}
\csvreader[head to column names]{../liste216.csv}{}{\sujet}

\end{document}
